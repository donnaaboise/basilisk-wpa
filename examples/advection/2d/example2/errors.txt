5/13/2019
---------
Wave propagation algorithm in Basilisk
Advection problem (advection/example2)

dt0 = 2e-2
N0 = 16;
nout0 = 250
nstep0 = 25
uniform grid

CFL_max <= 0.5


% --------------------------
% Basilisk data (no fixed time step; using 'bump' initial conditions)
% --------------------------

16   0.0348871   0.0892891   0.683545
32   0.0220961   0.0625587   0.512394 
64   0.0101871   0.03166     0.256551
128  0.00276266  0.00925407  0.0780435
256  0.000485167 0.00162797  0.0138565
512  0.000126747 0.000460678 0.00370881
1024 9.17097e-05 0.000331984 0.00241502

          Convergence rates
---------------------------------------
   32/   16   0.6589   0.5133   0.4158
   64/   32   1.1170   0.9825   0.9980
  128/   64   1.8826   1.7745   1.7169
  256/  128   2.5095   2.5070   2.4937
  512/  256   1.9365   1.8212   1.9015
 1024/  512   0.4668   0.4726   0.6189
---------------------------------------



------------------------------------
Waveprop algorithm in Basilisk
order = 2
limiter = 3
qinit = bump (exponential function)


 16   4.1258015656811559e-02   1.0029573585951281e-01   7.7094467752819540e-01
 32   2.7448467560506833e-02   7.8622802315258283e-02   6.7039730569268718e-01
 64   1.4514894135347369e-02   4.8369547117656106e-02   4.3494736958645375e-01
128   5.2084713982242029e-03   1.9956946354133157e-02   2.1446151492472387e-01
256   1.6040622827464849e-03   6.8032654713566275e-03   8.6648918718958079e-02

         Convergence rates
-------------------------------------
   32/   16   0.5879   0.3512   0.2016
   64/   32   0.9192   0.7008   0.6242
  128/   64   1.4786   1.2772   1.0201
  256/  128   1.6991   1.5526   1.3075
-------------------------------------

order = 2
limiter = 0
qinit = bump (exponential function)


  16      2.3748889989520877e-02   5.9764878978047491e-02   4.0167047000825029e-01
  32      1.1642871424072321e-02   3.5970106712683574e-02   2.4821475621897249e-01
  64      4.6329254212167399e-03   1.7054704749418476e-02   1.4841002042874460e-01
 128      2.0624051455745852e-03   7.8719755619386361e-03   7.0462141877301543e-02
 256      1.0232361266282488e-03   3.9052633988799221e-03   3.3999039431348965e-02
 512      5.1319210140362691e-04   1.9554522874107218e-03   1.6883429891808355e-02

         Convergence rates
---------------------------------------
   32/   16   1.0284   0.7325   0.6944
   64/   32   1.3295   1.0766   0.7420
  128/   64   1.1676   1.1154   1.0747
  256/  128   1.0112   1.0113   1.0514
  512/  256   0.9956   0.9979   1.0099
---------------------------------------


-----------------------------------------
Wednesday 5/22/2019 (flight from Calgary)
-----------------------------------------
Wave propagation algorithm in Basilisk
Advection problem (advection/example2)
Using non-conservative form? 

dt0 = 2e-2
N0 = 16
nout0 = 250
nstep0 = 25

CFL_max ~0.5


order = 2
limiter = 0
qinit = Hsmooth(r+r0) - Hsmooth(r-r0) (tanh) initial condition (e = 0.015625)
# Fixed bug in error checking (wasn't using correct q0)

16      4.8361747673094181e-02   1.0878446396539647e-01   5.5625842966496819e-01
32      2.4900337874320673e-02   7.1670666278418046e-02   4.9082787797897220e-01
64      1.3200411560368958e-02   4.6370144802719518e-02   3.8690275024334109e-01
128     6.1346278274888068e-03   2.6448079163523566e-02   2.9226305590035162e-01
256     2.4036565190245327e-03   1.2891196268168091e-02   1.8664872248847331e-01

          Convergence rates
---------------------------------------
   32/   16   0.9577   0.6020   0.1805
   64/   32   0.9156   0.6282   0.3432
  128/   64   1.1055   0.8100   0.4047
  256/  128   1.3517   1.0368   0.6469
---------------------------------------



------------------------
Thursday 5/23/2019
------------------------
Wave propagation algorithm in Basilisk
Advection problem (advection/example2)

dt0 = 2e-2
N0 = 16;
nout0 = 250
nstep0 = 25

CFL_max ~0.5



# Using fwaves
order = 2
limiter = 0;
qinit = Hsmooth


# WPA (timing)
# Quadtree,   250 steps,     0.030371 CPU,     0.03062 real, 2.09e+06 points.step/s, 5 var 
# Quadtree,   500 steps,     0.12735  CPU,     0.1282  real, 3.99e+06 points.step/s, 5 var
# Quadtree,  1000 steps,     0.81166  CPU,     0.814   real, 5.03e+06 points.step/s, 5 var
# Quadtree,  2000 steps,     6.76351  CPU,     6.802   real, 4.82e+06 points.step/s, 5 var
# Quadtree,  4000 steps,    51.7636   CPU,    51.87    real, 5.05e+06 points.step/s, 5 var
# Quadtree,  8000 steps,   397.07     CPU,   397.8     real, 5.27e+06 points.step/s, 5 var
# Quadtree, 16000 steps,  3079.99     CPU,  3086       real, 5.44e+06 points.step/s, 5 var
# Quadtree, 32000 steps, 25596.       CPU, 25650       real, 5.23e+06 points.step/s, 5 var  **



# ** Extrapolate to get time for 32000 case.
# Quadtree, 6400 steps, 5119.2 CPU, 5130 real, 5.23e+06 points.step/s, 5 var


# Original case (note real time)
# Quadtree, 32000 steps, 28335.4      CPU, 60740       real, 2.21e+06 points.step/s, 5 var



# WPA (accuracy)
16      4.8603152562983788e-02   1.0834811068784592e-01   5.3811470153198404e-01
32      2.3663034901910952e-02   6.6612092981253535e-02   3.8683254042696891e-01
64      1.2307943250447449e-02   4.1614772582544889e-02   3.0707003695617513e-01
128     5.5966678127598547e-03   2.3117409879671143e-02   2.2478623772307565e-01
256     2.0467937385292025e-03   1.0403961615723697e-02   1.3426019242310960e-01
512     5.7083696055456104e-04   3.5142430280459460e-03   6.1081837399226679e-02
1024    1.4027527017387525e-04   9.5172753562389688e-04   2.1363450404797979e-02
2048    5.2247571982631963e-05   3.2885809472103518e-04   7.2814485781029226e-03

          Convergence rates
---------------------------------------
   32/   16   1.0384   0.7018   0.4762
   64/   32   0.9430   0.6787   0.3331
  128/   64   1.1369   0.8481   0.4500
  256/  128   1.4512   1.1518   0.7435
  512/  256   1.8422   1.5658   1.1362
 1024/  512   2.0248   1.8846   1.5156
 2048/ 1024   1.4248   1.5331   1.5528
---------------------------------------

# Timing (WPA)
2.09e+06 
3.99e+06
5.03e+06
4.82e+06
5.05e+06
5.27e+06
5.44e+06
5.23e+06    % **** extrapolated

----------
5/25/2019
----------

------------------------------------------------------------
# Basilisk results (no limiters;  see advection_basilisk.h)
------------------------------------------------------------
# Quadtree,   250 steps,     0.010371 CPU,    0.01039  real, 6.16e+06 points.step/s, 7 var
# Quadtree,   500 steps,     0.051803 CPU,    0.05194  real, 9.86e+06 points.step/s, 7 var
# Quadtree,  1000 steps,     0.342643 CPU,    0.3438   real, 1.19e+07 points.step/s, 7 var
# Quadtree,  2000 steps,     2.43492  CPU,    2.437    real, 1.34e+07 points.step/s, 7 var
# Quadtree,  4000 steps,    18.5034   CPU,   18.53     real, 1.41e+07 points.step/s, 7 var
# Quadtree,  8000 steps,   214.455    CPU,   214.8     real, 9.76e+06 points.step/s, 7 var
# Quadtree, 16000 steps,  1594.5      CPU,  1597       real, 1.05e+07 points.step/s, 7 var
# Quadtree, 32000 steps, 12541.5      CPU, 1.258e+04   real, 1.07e+07 points.step/s, 7 var


16      7.0133509549783590e-02   1.5852765943703137e-01   7.5269847746259866e-01
32      4.7333112612975327e-02   1.1627316682975741e-01   6.1585491457087849e-01
64      2.5115782306653033e-02   7.1553248813614703e-02   4.1607084836776254e-01
128     1.3048241749528490e-02   4.3387504940317234e-02   2.9691137584798166e-01
256     5.8486818585033176e-03   2.3455987425737675e-02   2.0744263083027215e-01
512     2.0106812757518877e-03   1.0077166571835588e-02   1.1850431678542428e-01
1024    4.9073711882826416e-04   3.1341327064576675e-03   4.8684027024880949e-02
2048    8.5864288990516538e-05   6.5948859565517564e-04   1.2937784437279332e-02


         Convergence rates
---------------------------------------
   32/   16   0.5673   0.4472   0.2895
   64/   32   0.9143   0.7004   0.5658
  128/   64   0.9447   0.7217   0.4868
  256/  128   1.1577   0.8873   0.5173
  512/  256   1.5404   1.2189   0.8078
 1024/  512   2.0347   1.6850   1.2834
---------------------------------------

# BASILISK : Timing data
6.16e+06
9.86e+06
1.19e+07
1.34e+07
1.41e+07
9.76e+06
1.05e+07
1.07e+07

-----------
ForestClaw
-----------
grid size : 16x16 (order (2,0))


16     4.9606e-02  1.1069e-01 5.4619e-01         250       0.02917
32     2.4638e-02  6.9389e-02 4.0253e-01        2000       0.114281
64     1.3002e-02  4.3449e-02 2.9063e-01       16000       0.679176
128    6.1347e-03  2.4574e-02 2.1348e-01      128000       4.90876
256    2.2882e-03  1.1260e-02 1.2842e-01     1024000      37.6991
512    6.1975e-04  3.8095e-03 5.6094e-02     8192000     300.422 
1024   1.1885e-04  8.7686e-04 1.6201e-02  6.5536e+07    2364.79


Timing data (FC) 
   2.1940e6
   4.4801e6
   6.0308e6
   6.6754e6
   6.9535e6
   6.9806e6
   7.0945e6


Using 32x32 grids;  order = (2,2) (for all but smallest grid)

16     4.9606e-02  1.1069e-01 5.4619e-01        250        0.02917   % Use 16x16 grid
32     2.4638e-02  6.9389e-02 4.0253e-01        500        0.107063
64     1.3002e-02  4.3449e-02 2.9063e-01       4000        0.45847   
128    6.1347e-03  2.4574e-02 2.1348e-01      32000        3.46849
256    2.2882e-03  1.1260e-02 1.2842e-01     256000       26.5405
512    6.1975e-04  3.8095e-03 5.6094e-02    2048000      216.605  
1024   1.1885e-04  8.7686e-04 1.6201e-02   16384000     1702.83
2048   1.7413e-05  1.4250e-04 3.0422e-03  131072000    14503.2


Timing (FC, using 32x32 grids)
   2.19403e6
   4.78223e6
   8.93406e6
   9.44733e6
   9.87713e6
   9.68191e6
   9.85254e6
   9.25435e6



Re-do WPA version so that Riemann problems are only called once per interface when limiting
is not used. 


# Quadtree,   250 steps,     0.015812 CPU,     0.01601 real, 4.00e+06  points.step/s, 5 var
# Quadtree,   500 steps,     0.091944 CPU,     0.09203 real, 5.56e+06  points.step/s, 5 var
# Quadtree,  1000 steps,     0.677168 CPU,     0.6802  real, 6.02e+06  points.step/s, 5 var
# Quadtree,  2000 steps,     4.88803  CPU,     4.894   real, 6.70e+06  points.step/s, 5 var
# Quadtree,  4000 steps,    38.6722   CPU,    38.78    real, 6.76e+06  points.step/s, 5 var
# Quadtree,  8000 steps,   327.495    CPU,   328.4     real, 6.39e+06  points.step/s, 5 var
# Quadtree, 16000 steps,  4141.89     CPU,  4160.      real, 4.03e+06  points.step/s, 5 var
# Quadtree, 32000 steps, 33112        CPU, 33210.      real, 4.04e+06  points.step/s, 5 var


16      4.8603152562983788e-02   1.0834811068784592e-01   5.3811470153198404e-01
32      2.3663034901910952e-02   6.6612092981253535e-02   3.8683254042696891e-01
64      1.2307943250447449e-02   4.1614772582544889e-02   3.0707003695617513e-01
128     5.5966678127598547e-03   2.3117409879671143e-02   2.2478623772307565e-01
256     2.0467937385292025e-03   1.0403961615723697e-02   1.3426019242310960e-01
512     5.7083696055456104e-04   3.5142430280459460e-03   6.1081837399226679e-02
1024    1.4027527017387525e-04   9.5172753562389688e-04   2.1363450404797979e-02
2048    5.2247571982631963e-05   3.2885809472103518e-04   7.2814485781029226e-03

Timing
4.00e+06
5.56e+06
6.02e+06
6.70e+06
6.76e+06
6.39e+06
4.03e+06
4.04e+06


------------------------
Tuesday 5/28/2019
------------------------
# Color equation + WPA

# Quadtree,   250 steps,     0.017644 CPU,     0.01766 real, 3.62e+06 points.step/s, 7 var
# Quadtree,   500 steps,     0.094248 CPU,     0.09475 real, 5.40e+06 points.step/s, 7 var
# Quadtree,  1000 steps,     0.647041 CPU,     0.6546  real, 6.26e+06 points.step/s, 7 var
# Quadtree,  2000 steps,     5.15073  CPU,     5.216   real, 6.28e+06 points.step/s, 7 var
# Quadtree,  4000 steps,    41.9602   CPU,    42.1     real, 6.23e+06 points.step/s, 7 var
# Quadtree,  8000 steps,   374.315    CPU,   375.6     real, 5.58e+06 points.step/s, 7 var
# Quadtree, 16000 steps,  4414.93     CPU,  4435.      real, 3.78e+06 points.step/s, 7 var
# Quadtree, 32000 steps, 32556.2      CPU, 52230.      real, 4.12e+06 points.step/s, 7 var ***

# Accuracy (color equation + WPA)
16      4.8361747673094181e-02   1.0878446396539647e-01   5.5625842966496819e-01
32      2.4900337874320673e-02   7.1670666278418046e-02   4.9082787797897220e-01
64      1.3200411560368958e-02   4.6370144802719518e-02   3.8690275024334109e-01
128     6.1346278274888068e-03   2.6448079163523566e-02   2.9226305590035162e-01
256     2.4036565190245327e-03   1.2891196268168091e-02   1.8664872248847331e-01
512     8.3135495889491602e-04   5.4683324211929280e-03   9.7128181755126719e-02
1024    3.5448319490828634e-04   2.3706632922562451e-03   4.2865578723500219e-02
2048    1.7639396287489741e-04   1.1431503780907530e-03   1.9034171150887735e-02


Timing (WPA + color equation)
--------
3.62e+06
5.40e+06
6.26e+06
6.28e+06
6.23e+06
5.58e+06
3.78e+06
4.12e+06    % Computed using CPU time (not real time)


------------------------------------------------------------------------------------------
                                    Tuesday 6/12/2019
------------------------------------------------------------------------------------------
# -------------------------------
# WPA
# -------------------------------

% Advection (convergence test)
# Fix transport problem so it looks more like Basilisk

/* WPA (using multigrid) */

# Multigrid,  250 steps,     0.013604 CPU,    0.01373 real, 4.66e+06 points.step/s, 5 var
# Multigrid,  500 steps,     0.080494 CPU,    0.08059 real, 6.35e+06 points.step/s, 5 var
# Multigrid, 1000 steps,     0.579111 CPU,    0.5824  real, 7.03e+06 points.step/s, 5 var
# Multigrid, 2000 steps,     4.24961  CPU,    4.253   real, 7.70e+06 points.step/s, 5 var
# Multigrid, 4000 steps,    32.6628   CPU,   32.72    real, 8.01e+06 points.step/s, 5 var
# Multigrid, 8000 steps,   266.06     CPU,  267       real, 7.86e+06 points.step/s, 5 var
# Multigrid, 16000 steps, 2175.67     CPU, 2181       real, 7.69e+06 points.step/s, 5 var

16      4.8603152562983781e-02   1.0834811068784590e-01   5.3811470153198404e-01
32      2.3663034901910955e-02   6.6612092981253493e-02   3.8683254042696891e-01
64      1.2307943250447475e-02   4.1614772582544889e-02   3.0707003695617513e-01
128     5.5966678127598842e-03   2.3117409879671161e-02   2.2478623772307565e-01
256     2.0467937385292025e-03   1.0403961615723697e-02   1.3426019242310960e-01
512     5.7083696055459324e-04   3.5142430280459538e-03   6.1081837399226679e-02
1024    1.4027527017390452e-04   9.5172753562390697e-04   2.1363450404797979e-02

# .... results are identical to those from above (although faster with multigrid)

# -------------------------------
# Basilisk (using fixed dt) 
# -------------------------------

# Multigrid,   250 steps,    0.008887 CPU,    0.008883 real, 7.20e+06 points.step/s, 7 var
# Multigrid,   500 steps,    0.040973 CPU,    0.04106  real, 1.25e+07 points.step/s, 7 var
# Multigrid,  1000 steps,    0.253661 CPU,    0.2542   real, 1.61e+07 points.step/s, 7 var
# Multigrid,  2000 steps,    1.82635  CPU,    1.832    real, 1.79e+07 points.step/s, 7 var
# Multigrid,  4000 steps,   15.8017   CPU,   15.82     real, 1.66e+07 points.step/s, 7 var
# Multigrid,  8000 steps,  116.341    CPU,  116.5      real, 1.80e+07 points.step/s, 7 var
# Multigrid, 16000 steps,  958.974    CPU,  960.5      real, 1.75e+07 points.step/s, 7 var

#  Accuracy (Basilisk)
16      7.0133509549783549e-02   1.5852765943703137e-01   7.5269847746259866e-01
32      4.7333112612975334e-02   1.1627316682975740e-01   6.1585491457087849e-01
64      2.5115782306653001e-02   7.1553248813614731e-02   4.1607084836776254e-01
128     1.3048241749528481e-02   4.3387504940317255e-02   2.9691137584798166e-01
256     5.8488673515357205e-03   2.3456225086427151e-02   2.0738806004388266e-01
512     2.0106812757521718e-03   1.0077166571835629e-02   1.1850431678542428e-01
1024    4.9073711882848458e-04   3.1341327064577100e-03   4.8684027024880949e-02



------------------------------------------------------------------------------------------
                                 Wednesday 6/12/2019
------------------------------------------------------------------------------------------

# transport.c  (conservative transport)
# Using variable time step
# No fixed number of time steps
# 

# -----------
# WPA results
# -----------
64      6.3425614731351231e-03   2.1814477594212237e-02   1.6911793915280970e-01
128     2.1363491645811526e-03   8.2102203122403558e-03   7.7643629663214697e-02
256     9.0332494277948778e-04   3.4124091414908441e-03   3.0255475917795649e-02
512     4.7236468419122149e-04   1.6641927254140156e-03   1.2919158621749971e-02
1024    3.0435652635429125e-04   1.0197568983345620e-03   7.2714215044898944e-03


          Convergence rates
---------------------------------------
  128/   64   1.5699   1.4098   1.1231
  256/  128   1.2418   1.2666   1.3597
  512/  256   0.9353   1.0360   1.2277
 1024/  512   0.6341   0.7066   0.8292
---------------------------------------

# ----------------
# Basilisk results
# ----------------

64      1.0295609789214235e-02   3.1945184283451354e-02   2.5851022458890249e-01
128     2.7710467962603394e-03   9.2672813425529899e-03   7.7532293155290199e-02
256     4.7052630157333258e-04   1.5673384574422234e-03   1.3150245631665003e-02
512     6.6740717762656861e-05   2.1208426780959188e-04   1.7325212813452673e-03
1024    9.3848448887527257e-06   3.0159955437160236e-05   6.3650699129607280e-04


          Convergence rates
---------------------------------------
  128/   64   1.8935   1.7854   1.7374
  256/  128   2.5581   2.5638   2.5597
  512/  256   2.8176   2.8856   2.9241
 1024/  512   2.8302   2.8139   1.4446
---------------------------------------

------------------------------------------------------------------------------------------
                                 Thursday 6/13/2019
------------------------------------------------------------------------------------------

# WPA (using generalized minmod limiter 6)
64      1.4072371516427823e-02   4.7947905728563195e-02   4.2583387160273722e-01
128     4.8430178561669462e-03   1.9384116634402915e-02   1.9723909350235502e-01
256     1.5129550399177244e-03   6.6079188893551442e-03   8.1017525376045008e-02
512     6.0162804065322600e-04   2.4397698964427261e-03   6.1800776696482998e-02


# Basilisk (using minmod limiter)
